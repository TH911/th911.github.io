---
layout: post
title: "题解：[SCOI2005] 互不侵犯"
subtitle: "洛谷P1896"
date: 2024-10-17
author: "TH911"
header-img: "img/2024/10/006.jpeg"
header-mask: 0.4
tags:
  - 题解
  - 洛谷
  - DP
  - 状压DP
---

> [洛谷同步链接](https://www.luogu.com.cn/article/7if7f3dx)
>
> [题目传送门](https://www.luogu.com.cn/problem/P1896)

## 什么是状压DP

> 状压 DP 是动态规划的一种，通过将状态压缩为整数来达到优化转移的目的。
>
> ——[OI Wiki](https://oi-wiki.org/dp/state/#%E5%AE%9A%E4%B9%89)

### 状态压缩

例如，给定一个 `bool` 数组 $c$，那么 $c_i$ 为 $0$ 或 $1$。

我们可以将其压缩为一个二进制整数 $(a)_2$，这样 `a&(1<<i)` 即 $c_i$。可以参照下表：

|      $i$       |  0   |  1   |  2   |  3   |  4   |  5   |  6   |  7   |
| :------------: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|     $c_i$      | $0$  | $1$  | $0$  | $1$  | $1$  | $0$  | $0$  | $1$  |
| `(a)_2&(1<<i)` | $0$  | $1$  | $0$  | $1$  | $1$  | $0$  | $0$  | $1$  |

此时，$(a)_2=(10011010)_2,a=154$。

### 状压DP

在此基础上进行DP，状态的转移化为了整数，那么状态转移同样**得到了优化**。

## 设计状态压缩

首先，这是一个 $N\times N$ 的棋盘。

那么，我们考虑**压缩一行为一个整数**。（当然，压缩列同样可行，你只需要“将棋盘转 $90^\circ$”）

$0$ 表示并没有放置国王，$1$ 表示放置了国王。那么比如 $74=(01001010)_2$ 表示的便是这样的一行：

![](https://cfyy.us.kg/img/2024/10/011.png)

## 设计状态转移

我们定义 $dp[i][j][k]$ 表示：

* DP至第 $i$ 行；
* 共放置了 $j$ 个国王（由于题目给出“放置 $K$ 个国王”）；
* 第 $i-1$ 行状态为 $k$（因为国王**会影响到下一行的状态**）。

一个很明显的结论是国王周围 $8$ 个格子内**不能**有其他国王（如图）。

![国王放置情况](https://cfyy.us.kg/img/2024/10/012.png)