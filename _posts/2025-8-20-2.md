---
layout: post
title: "李超线段树"
subtitle: "例题：洛谷P4097"
date: 2025-8-20
author: "TH911"
header-img: "img/2024/10/006.jpeg"
header-mask: 0.4
tags:
  - 题解
  - 省选/NOI−
  - 线段树
  - 李超线段树
  - 基础算法
words:
---

> [例题链接](https://www.luogu.com.cn/problem/P4097)
>
> 要求在平面直角坐标系下维护两个操作：
>
> 1. 在平面上加入一条线段。记第 $i$ 条被插入的线段的标号为 $i$。
> 2. 给定一个数 $k$，询问与直线 $x = k$ 相交的线段中，交点纵坐标最大的线段的编号。
>
> 对于 $100\%$ 的数据，保证 $1 \leq n \leq 10^5$，$1 \leq k, x_0, x_1 \leq 39989$，$1 \leq y_0, y_1 \leq 10^9$。强制在线。

# 李超线段树

李超线段树